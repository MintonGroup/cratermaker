
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../production/">
      
      
        <link rel="next" href="../simulation/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.2">
    
    
      
        <title>Scale - CraterMaker Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scale-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CraterMaker Documentation" class="md-header__button md-logo" aria-label="CraterMaker Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CraterMaker Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Scale
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CraterMaker Documentation" class="md-nav__button md-logo" aria-label="CraterMaker Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CraterMaker Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cratermaker_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crater/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crater
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../morphology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Morphology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../production/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Scale
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Scale
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cratermaker.core.scale" class="md-nav__link">
    <span class="md-ellipsis">
      scale
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale" class="md-nav__link">
    <span class="md-ellipsis">
      Scale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.crater_to_projectile" class="md-nav__link">
    <span class="md-ellipsis">
      crater_to_projectile()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="crater_to_projectile()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.crater_to_projectile--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.crater_to_projectile--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.final_to_transient" class="md-nav__link">
    <span class="md-ellipsis">
      final_to_transient()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="final_to_transient()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.final_to_transient--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.final_to_transient--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.get_morphology_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_morphology_type()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_morphology_type()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.get_morphology_type--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.get_morphology_type--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.projectile_to_crater" class="md-nav__link">
    <span class="md-ellipsis">
      projectile_to_crater()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="projectile_to_crater()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.projectile_to_crater--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.transient_to_final" class="md-nav__link">
    <span class="md-ellipsis">
      transient_to_final()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transient_to_final()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.transient_to_final--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.transient_to_final--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../surface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Surface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../target/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Target
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Utilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../montecarlo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monte Carlo Utilities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cratermaker.core.scale" class="md-nav__link">
    <span class="md-ellipsis">
      scale
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale" class="md-nav__link">
    <span class="md-ellipsis">
      Scale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.crater_to_projectile" class="md-nav__link">
    <span class="md-ellipsis">
      crater_to_projectile()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="crater_to_projectile()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.crater_to_projectile--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.crater_to_projectile--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.final_to_transient" class="md-nav__link">
    <span class="md-ellipsis">
      final_to_transient()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="final_to_transient()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.final_to_transient--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.final_to_transient--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.get_morphology_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_morphology_type()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_morphology_type()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.get_morphology_type--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.get_morphology_type--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.projectile_to_crater" class="md-nav__link">
    <span class="md-ellipsis">
      projectile_to_crater()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="projectile_to_crater()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.projectile_to_crater--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.transient_to_final" class="md-nav__link">
    <span class="md-ellipsis">
      transient_to_final()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transient_to_final()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.transient_to_final--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cratermaker.core.scale.Scale.transient_to_final--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="scale-module">Scale Module</h1>


<div class="doc doc-object doc-module">



<a id="cratermaker.core.scale"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="cratermaker.core.scale.Scale" class="doc doc-heading">
          <code>Scale</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>An operations class for computing the scaling relationships between impactors and craters.</p>
<p>This class encapsulates the logic for converting between projectile properties and crater properties, 
as well as determining crater morphology based on size and target properties.</p>
<h4 id="cratermaker.core.scale.Scale--parameters">Parameters</h4>
<p>target : Target
    The target body for the impact simulation.
rng : Generator, optional
    A random number generator instance. If not provided, the default numpy RNG will be used.</p>

            <details class="quote">
              <summary>Source code in <code>cratermaker/core/scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Scale</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An operations class for computing the scaling relationships between impactors and craters.</span>

<span class="sd">    This class encapsulates the logic for converting between projectile properties and crater properties, </span>
<span class="sd">    as well as determining crater morphology based on size and target properties.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    target : Target</span>
<span class="sd">        The target body for the impact simulation.</span>
<span class="sd">    rng : Generator, optional</span>
<span class="sd">        A random number generator instance. If not provided, the default numpy RNG will be used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Target</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;target must be an instance of Target&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">Generator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">rng</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The &#39;rng&#39; argument must be a numpy.random.Generator instance or None&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>

        <span class="c1"># Initialize additional attributes for simple-&gt;complex transition scale factors. These are set to None here just for clarity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transition_diameter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simple_enlargement_factor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complex_enlargement_factor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_exp</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Initialize transition factors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_simple_to_complex_transition_factors</span><span class="p">()</span> 
        <span class="k">return</span>


    <span class="k">def</span> <span class="nf">_compute_simple_to_complex_transition_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes and sets the internal attributes for transition factors between simple and complex craters.</span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="c1"># These terms are used to compute the ratio of the transient crater to simple crater size       </span>
        <span class="n">simple_enlargement_mean</span> <span class="o">=</span> <span class="mf">0.84</span> <span class="c1"># See Melosh (1989) pg. 129 just following eq. 8.2.1</span>
        <span class="n">simple_enlargement_std</span> <span class="o">=</span> <span class="mf">0.04</span> <span class="c1"># Just using Pike (1980) fig. 9 the crater depth varies by about the same amount on either side of the transition so this is a reasonable assumption</span>

        <span class="c1"># These terms are used in the exponent in the final rim radius/ simple crater radius vs  final radius / transition radius relationship</span>
        <span class="c1"># See Holsapple (1993) eq. 28</span>
        <span class="n">final_exp_mean</span> <span class="o">=</span> <span class="mf">0.079</span>    
        <span class="n">final_exp_std</span> <span class="o">=</span> <span class="mf">0.0001</span> <span class="c1"># We add noise because this is nature and nature messy</span>
        <span class="n">complex_enlargement_factor</span> <span class="o">=</span> <span class="mf">1.02</span>

        <span class="c1"># These terms are used to compute the transition diameter as a function of gravity</span>
        <span class="c1"># The transition values come from CTEM and are a synthesis of Pike (1980), Croft (1985), Schenk et al. (2004).</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">transition_scale_type</span> <span class="o">==</span> <span class="s2">&quot;silicate&quot;</span><span class="p">:</span>
            <span class="n">simple_complex_exp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0303</span> 
            <span class="n">simple_complex_mean</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">16533.8</span> 
            <span class="n">simple_complex_std</span> <span class="o">=</span> <span class="mf">0.04</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">transition_scale_type</span> <span class="o">==</span> <span class="s2">&quot;ice&quot;</span><span class="p">:</span>
            <span class="n">simple_complex_exp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.22486</span>
            <span class="n">simple_complex_mean</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mf">3081.39</span>
            <span class="n">simple_complex_std</span> <span class="o">=</span> <span class="mf">0.04</span>

        <span class="c1"># The nominal value will be used for determining the range of the &quot;transitional&quot; morphology type</span>
        <span class="n">transition_nominal</span><span class="o">=</span> <span class="n">simple_complex_mean</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">gravity</span><span class="o">**</span><span class="n">simple_complex_exp</span>

        <span class="c1"># Draw from a truncated normal distribution for each component of the model</span>
        <span class="n">simple_enlargement_factor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">mc</span><span class="o">.</span><span class="n">bounded_norm</span><span class="p">(</span><span class="n">simple_enlargement_mean</span><span class="p">,</span> <span class="n">simple_enlargement_std</span><span class="p">)</span>
        <span class="n">final_exp</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">bounded_norm</span><span class="p">(</span><span class="n">final_exp_mean</span><span class="p">,</span> <span class="n">final_exp_std</span><span class="p">)</span>
        <span class="n">simple_complex_fac</span> <span class="o">=</span> <span class="n">simple_complex_mean</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">simple_complex_std</span><span class="p">))</span>
        <span class="n">transition_diameter</span> <span class="o">=</span> <span class="n">simple_complex_fac</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">gravity</span><span class="o">**</span><span class="n">simple_complex_exp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transition_diameter</span> <span class="o">=</span> <span class="n">transition_diameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="o">=</span><span class="n">transition_nominal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simple_enlargement_factor</span> <span class="o">=</span> <span class="n">simple_enlargement_factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complex_enlargement_factor</span> <span class="o">=</span> <span class="n">complex_enlargement_factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_exp</span> <span class="o">=</span> <span class="n">final_exp</span>
        <span class="k">return</span> 


    <span class="k">def</span> <span class="nf">get_morphology_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_diameter</span><span class="p">:</span> <span class="n">FloatLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes and the morphology type of a crater and returns a string corresponding to its type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        final_diameter : float</span>
<span class="sd">            The diameter of the crater to compute</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        str</span>
<span class="sd">            The type of crater &quot;simple&quot;, &quot;complex&quot;, or &quot;transitional&quot; </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Use the 1/2x to 2x the nominal value of the simple-&gt;complex transition diameter to get the range of the &quot;transitional&quot; morphology type. This is supported by: Schenk et al. (2004) and Pike (1980) in particular  </span>
        <span class="n">transition_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">final_diameter</span> <span class="o">&lt;</span> <span class="n">transition_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">morphology_type</span> <span class="o">=</span> <span class="s2">&quot;simple&quot;</span> 
        <span class="k">elif</span> <span class="n">final_diameter</span> <span class="o">&gt;</span> <span class="n">transition_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">morphology_type</span> <span class="o">=</span> <span class="s2">&quot;complex&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># We&#39;ll uses the distance from the nominal transition diameter to set a probability of being either simple, complex, or transitional.</span>
            <span class="k">if</span> <span class="n">final_diameter</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span> <span class="o">-</span> <span class="n">final_diameter</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span> <span class="o">-</span> <span class="n">transition_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span><span class="s2">&quot;transitional&quot;</span><span class="p">]</span>
                <span class="n">prob</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">p</span><span class="p">]</span> 
                <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">prob</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">final_diameter</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">transition_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">)</span>
                <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;complex&quot;</span><span class="p">,</span><span class="s2">&quot;transitional&quot;</span><span class="p">]</span>
                <span class="n">prob</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">p</span><span class="p">]</span> 
                <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">prob</span><span class="p">)</span>                

        <span class="k">return</span> <span class="n">morphology_type</span>


    <span class="k">def</span> <span class="nf">f2t_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Df</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">simple_enlargement_factor</span>


    <span class="k">def</span> <span class="nf">f2t_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Df</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Df</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simple_enlargement_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">complex_enlargement_factor</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Df</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_diameter</span><span class="p">)</span><span class="o">**-</span><span class="bp">self</span><span class="o">.</span><span class="n">final_exp</span>


    <span class="k">def</span> <span class="nf">final_to_transient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_diameter</span><span class="p">:</span> <span class="n">FloatLike</span><span class="p">,</span> <span class="n">morphology_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the transient diameter of a crater based on its final diameter and morphology type.</span>

<span class="sd">        This method first ensures that the morphology type of the crater is computed. It then calculates</span>
<span class="sd">        the transient crater diameter based on the final diameter using scaling factors for simple or complex</span>
<span class="sd">        crater morphologies.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        final_diameter : float-like</span>
<span class="sd">            The final crater diameter in meters for which to compute the transient diameter.</span>
<span class="sd">        morphology_type : str, optional</span>
<span class="sd">            The morphology type of the crater (&quot;simple&quot;, &quot;complex&quot;, &quot;transitional&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.float64</span>
<span class="sd">            Returns the crater transient diameter in meters</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">morphology_type</span><span class="p">:</span>
            <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_morphology_type</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span> 

        <span class="k">if</span> <span class="n">morphology_type</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span> 
            <span class="n">transient_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f2t_simple</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transient_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f2t_complex</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span>

        <span class="n">transient_diameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">transient_diameter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">transient_diameter</span><span class="p">,</span> <span class="n">morphology_type</span>


    <span class="k">def</span> <span class="nf">transient_to_final</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transient_diameter</span><span class="p">:</span> <span class="n">FloatLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the final diameter of a crater based on its transient diameter and morphology type.</span>

<span class="sd">        This method first ensures that the morphology type of the crater is computed. It then calculates</span>
<span class="sd">        the final crater diameter based on the transient diameter using scaling factors for simple or complex</span>
<span class="sd">        crater morphologies. This is a bit more complicated than the final-&gt;transient calculation  because In </span>
<span class="sd">        the transition region, a particular transient crater diameter could be associate with simple, complex, </span>
<span class="sd">        or transitional crater morphologies. Therefore we need to monte carlo our way into a solution to avoid </span>
<span class="sd">        biasing in favor of one or another in the transient-&gt;final computation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        transient_diameter : float-like</span>
<span class="sd">            The transient diameter in meters of the crater to convert to final</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.float64</span>
<span class="sd">            The final crater diameter</span>
<span class="sd">        str</span>
<span class="sd">            The morphology type of the crater</span>
<span class="sd">        &quot;&quot;&quot;</span> 

        <span class="c1"># Invert the final -&gt; transient functions for  each crater type</span>
        <span class="n">final_diameter_simple</span> <span class="o">=</span> <span class="n">transient_diameter</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">simple_enlargement_factor</span>
        <span class="k">def</span> <span class="nf">root_func</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">,</span><span class="n">Dt</span><span class="p">,</span><span class="n">scale</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">scale</span><span class="o">.</span><span class="n">f2t_complex</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span> <span class="o">-</span> <span class="n">Dt</span>

        <span class="n">sol</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">root_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span><span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">final_diameter_simple</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">final_diameter_simple</span><span class="p">),</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">transient_diameter</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
        <span class="n">final_diameter_complex</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">root</span>

        <span class="c1"># Evaluate the potential morphology that this transient crater could be consistent with. If both potential diameter values are unambigusously is unambiguosuly simple or complex, go with that.</span>
        <span class="c1"># If there is disagreement, then we&#39;ll draw the answer from a hat and just check to make sure that final_diameter &gt; transient_diameter </span>
        <span class="n">morphology_options</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_morphology_type</span><span class="p">(</span><span class="n">final_diameter_simple</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">get_morphology_type</span><span class="p">(</span><span class="n">final_diameter_complex</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">morphology_options</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># We have agreement!</span>
            <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">morphology_type</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span>
                <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_simple</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_complex</span> <span class="c1"># this includes transitional types as well</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">if</span> <span class="s2">&quot;simple&quot;</span> <span class="ow">in</span> <span class="n">morphology_options</span><span class="p">:</span> <span class="c1"># The disagreement is between simple/complex or simple/transitional</span>
                <span class="k">if</span> <span class="n">morphology_options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span>
                    <span class="n">sind</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">cind</span> <span class="o">=</span> <span class="mi">1</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sind</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">cind</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="c1"># Randomly draw a morphology based on weighting by whichever option is closest to the transition </span>
                <span class="n">is_simple</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">final_diameter_complex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_diameter</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">final_diameter_simple</span> <span class="o">-</span> <span class="n">final_diameter_complex</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">is_simple</span><span class="p">:</span>
                    <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_simple</span>
                    <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_options</span><span class="p">[</span><span class="n">sind</span><span class="p">]</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_complex</span>
                    <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_options</span><span class="p">[</span><span class="n">cind</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_complex</span>
                <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">morphology_options</span><span class="p">)</span>

        <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span>
        <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_type</span>
        <span class="k">return</span> <span class="n">final_diameter</span><span class="p">,</span> <span class="n">morphology_type</span>


    <span class="k">def</span> <span class="nf">projectile_to_crater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projectile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a projectile to its corresponding crater.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        projectile : Projectile</span>
<span class="sd">            The projectile to be converted.</span>
<span class="sd">        target : Target</span>
<span class="sd">            The target body being impacted</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Crater</span>
<span class="sd">            The crater resulting from the impact of the projectile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.crater</span> <span class="kn">import</span> <span class="n">Crater</span>
        <span class="n">transient_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projectile_to_transient</span><span class="p">(</span><span class="n">projectile</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
        <span class="n">crater</span> <span class="o">=</span> <span class="n">Crater</span><span class="p">(</span><span class="n">transient_diameter</span><span class="o">=</span><span class="n">transient_diameter</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">crater</span>


    <span class="k">def</span> <span class="nf">crater_to_projectile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crater</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a crater back to its corresponding projectile.</span>
<span class="sd">        This operation is more hypothetical and approximates the possible projectile that created the crater.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        crater : Crater</span>
<span class="sd">            The crater to be converted.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Projectile</span>
<span class="sd">            The estimated projectile that could have caused the crater.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">projectile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transient_to_projectile</span><span class="p">(</span><span class="n">crater</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">projectile</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">projectile_to_transient</span><span class="p">(</span><span class="n">projectile</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.crater</span> <span class="kn">import</span> <span class="n">Projectile</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">projectile</span><span class="p">,</span> <span class="n">Projectile</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;target must be an instance of Projectile&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Target</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;target must be an instance of Target&quot;</span><span class="p">)</span>

        <span class="c1"># Compute some auxiliary quantites</span>
        <span class="n">projectile</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">4.0</span><span class="o">/</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">projectile</span><span class="o">.</span><span class="n">density</span> <span class="o">*</span> <span class="p">(</span><span class="n">projectile</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">mu</span>
        <span class="n">kv</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">K1</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">mu</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">mu</span><span class="p">)</span>

        <span class="c1"># Find dimensionless quantities</span>
        <span class="n">pitwo</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">projectile</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">projectile</span><span class="o">.</span><span class="n">vertical_velocity</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">pithree</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">Ybar</span> <span class="o">/</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">density</span> <span class="o">*</span> <span class="p">(</span><span class="n">projectile</span><span class="o">.</span><span class="n">vertical_velocity</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">pifour</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">density</span> <span class="o">/</span> <span class="n">projectile</span><span class="o">.</span><span class="n">density</span>
        <span class="n">pivol</span> <span class="o">=</span> <span class="n">kv</span> <span class="o">*</span> <span class="p">((</span><span class="n">pitwo</span> <span class="o">*</span> <span class="p">(</span><span class="n">pifour</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">pithree</span><span class="o">**</span><span class="n">c1</span><span class="p">))</span><span class="o">**</span><span class="n">c2</span>
        <span class="n">pivolg</span> <span class="o">=</span> <span class="n">kv</span> <span class="o">*</span> <span class="p">(</span><span class="n">pitwo</span> <span class="o">*</span> <span class="p">(</span><span class="n">pifour</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)))</span><span class="o">**</span><span class="n">c2</span>

        <span class="c1"># find transient crater volume and radii (depth = 1/3 diameter)</span>
        <span class="n">cvol</span> <span class="o">=</span> <span class="n">pivol</span> <span class="o">*</span> <span class="p">(</span><span class="n">projectile</span><span class="o">.</span><span class="n">mass</span> <span class="o">/</span> <span class="n">target</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
        <span class="n">cvolg</span> <span class="o">=</span> <span class="n">pivolg</span> <span class="o">*</span> <span class="p">(</span><span class="n">projectile</span><span class="o">.</span><span class="n">mass</span> <span class="o">/</span> <span class="n">target</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
        <span class="n">transient_radius</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">cvol</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>
        <span class="n">transient_radius_gravscale</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">cvolg</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>

        <span class="n">transient_diameter</span> <span class="o">=</span> <span class="n">transient_radius</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">transient_diameter</span> <span class="o">&lt;</span> <span class="n">projectile</span><span class="o">.</span><span class="n">diameter</span><span class="p">:</span>
            <span class="n">transient_diameter</span> <span class="o">=</span> <span class="n">projectile</span><span class="o">.</span><span class="n">diameter</span>

        <span class="k">return</span> <span class="n">transient_diameter</span>


    <span class="k">def</span> <span class="nf">transient_to_projectile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crater</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">.crater</span> <span class="kn">import</span> <span class="n">Crater</span><span class="p">,</span> <span class="n">Projectile</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crater</span><span class="p">,</span> <span class="n">Crater</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;crater must be an instance of Crater&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Target</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;target must be an instance of Target&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rng</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">Generator</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The &#39;rng&#39; argument must be a numpy.random.Generator instance or None&quot;</span><span class="p">)</span>

        <span class="c1"># We&#39;ll create a Projectile object that will allow us to set velocity</span>
        <span class="n">projectile</span> <span class="o">=</span> <span class="n">Projectile</span><span class="p">(</span><span class="n">diameter</span><span class="o">=</span><span class="n">crater</span><span class="o">.</span><span class="n">transient_diameter</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">crater</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">root_func</span><span class="p">(</span><span class="n">projectile_diameter</span><span class="p">:</span> <span class="n">FloatLike</span><span class="p">,</span> 
                      <span class="n">projectile</span><span class="p">:</span> <span class="n">Projectile</span><span class="p">,</span> 
                      <span class="n">crater</span><span class="p">:</span> <span class="n">Crater</span><span class="p">,</span>
                      <span class="n">target</span><span class="p">:</span> <span class="n">Target</span><span class="p">,</span>
                      <span class="n">rng</span><span class="p">:</span> <span class="n">Generator</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>

            <span class="n">projectile</span><span class="o">.</span><span class="n">diameter</span> <span class="o">=</span> <span class="n">projectile_diameter</span>
            <span class="n">transient_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projectile_to_transient</span><span class="p">(</span><span class="n">projectile</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">transient_diameter</span> <span class="o">-</span> <span class="n">crater</span><span class="o">.</span><span class="n">transient_diameter</span> 

        <span class="n">sol</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">root_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span><span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-5</span><span class="o">*</span><span class="n">crater</span><span class="o">.</span><span class="n">transient_diameter</span><span class="p">,</span><span class="n">crater</span><span class="o">.</span><span class="n">transient_diameter</span><span class="p">),</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">projectile</span><span class="p">,</span> <span class="n">crater</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">))</span>

        <span class="c1"># Regenerate the projectile with the new diameter value</span>
        <span class="n">projectile</span> <span class="o">=</span> <span class="n">Projectile</span><span class="p">(</span><span class="n">diameter</span><span class="o">=</span><span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">projectile</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="n">projectile</span><span class="o">.</span><span class="n">velocity</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">projectile</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">projectile</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="cratermaker.core.scale.Scale.crater_to_projectile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">crater_to_projectile</span><span class="p">(</span><span class="n">crater</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert a crater back to its corresponding projectile.
This operation is more hypothetical and approximates the possible projectile that created the crater.</p>
<h5 id="cratermaker.core.scale.Scale.crater_to_projectile--parameters">Parameters</h5>
<p>crater : Crater
    The crater to be converted.</p>
<h5 id="cratermaker.core.scale.Scale.crater_to_projectile--returns">Returns</h5>
<p>Projectile
    The estimated projectile that could have caused the crater.</p>

          <details class="quote">
            <summary>Source code in <code>cratermaker/core/scale.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">crater_to_projectile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crater</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a crater back to its corresponding projectile.</span>
<span class="sd">    This operation is more hypothetical and approximates the possible projectile that created the crater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    crater : Crater</span>
<span class="sd">        The crater to be converted.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Projectile</span>
<span class="sd">        The estimated projectile that could have caused the crater.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">projectile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transient_to_projectile</span><span class="p">(</span><span class="n">crater</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">projectile</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="cratermaker.core.scale.Scale.final_to_transient" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">final_to_transient</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">,</span> <span class="n">morphology_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Computes the transient diameter of a crater based on its final diameter and morphology type.</p>
<p>This method first ensures that the morphology type of the crater is computed. It then calculates
the transient crater diameter based on the final diameter using scaling factors for simple or complex
crater morphologies.</p>
<h5 id="cratermaker.core.scale.Scale.final_to_transient--parameters">Parameters</h5>
<p>final_diameter : float-like
    The final crater diameter in meters for which to compute the transient diameter.
morphology_type : str, optional
    The morphology type of the crater ("simple", "complex", "transitional")</p>
<h5 id="cratermaker.core.scale.Scale.final_to_transient--returns">Returns</h5>
<p>np.float64
    Returns the crater transient diameter in meters</p>

          <details class="quote">
            <summary>Source code in <code>cratermaker/core/scale.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">final_to_transient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_diameter</span><span class="p">:</span> <span class="n">FloatLike</span><span class="p">,</span> <span class="n">morphology_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the transient diameter of a crater based on its final diameter and morphology type.</span>

<span class="sd">    This method first ensures that the morphology type of the crater is computed. It then calculates</span>
<span class="sd">    the transient crater diameter based on the final diameter using scaling factors for simple or complex</span>
<span class="sd">    crater morphologies.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    final_diameter : float-like</span>
<span class="sd">        The final crater diameter in meters for which to compute the transient diameter.</span>
<span class="sd">    morphology_type : str, optional</span>
<span class="sd">        The morphology type of the crater (&quot;simple&quot;, &quot;complex&quot;, &quot;transitional&quot;)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.float64</span>
<span class="sd">        Returns the crater transient diameter in meters</span>
<span class="sd">    &quot;&quot;&quot;</span>        
    <span class="k">if</span> <span class="ow">not</span> <span class="n">morphology_type</span><span class="p">:</span>
        <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_morphology_type</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span> 

    <span class="k">if</span> <span class="n">morphology_type</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span> 
        <span class="n">transient_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f2t_simple</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">transient_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f2t_complex</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span>

    <span class="n">transient_diameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">transient_diameter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">transient_diameter</span><span class="p">,</span> <span class="n">morphology_type</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="cratermaker.core.scale.Scale.get_morphology_type" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_morphology_type</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Computes and the morphology type of a crater and returns a string corresponding to its type.</p>
<h5 id="cratermaker.core.scale.Scale.get_morphology_type--parameters">Parameters</h5>
<p>final_diameter : float
    The diameter of the crater to compute</p>
<h5 id="cratermaker.core.scale.Scale.get_morphology_type--returns">Returns</h5>
<p>str
    The type of crater "simple", "complex", or "transitional"</p>

          <details class="quote">
            <summary>Source code in <code>cratermaker/core/scale.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_morphology_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_diameter</span><span class="p">:</span> <span class="n">FloatLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes and the morphology type of a crater and returns a string corresponding to its type.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    final_diameter : float</span>
<span class="sd">        The diameter of the crater to compute</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    str</span>
<span class="sd">        The type of crater &quot;simple&quot;, &quot;complex&quot;, or &quot;transitional&quot; </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Use the 1/2x to 2x the nominal value of the simple-&gt;complex transition diameter to get the range of the &quot;transitional&quot; morphology type. This is supported by: Schenk et al. (2004) and Pike (1980) in particular  </span>
    <span class="n">transition_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">final_diameter</span> <span class="o">&lt;</span> <span class="n">transition_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">morphology_type</span> <span class="o">=</span> <span class="s2">&quot;simple&quot;</span> 
    <span class="k">elif</span> <span class="n">final_diameter</span> <span class="o">&gt;</span> <span class="n">transition_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">morphology_type</span> <span class="o">=</span> <span class="s2">&quot;complex&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We&#39;ll uses the distance from the nominal transition diameter to set a probability of being either simple, complex, or transitional.</span>
        <span class="k">if</span> <span class="n">final_diameter</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span> <span class="o">-</span> <span class="n">final_diameter</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span> <span class="o">-</span> <span class="n">transition_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span><span class="s2">&quot;transitional&quot;</span><span class="p">]</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">p</span><span class="p">]</span> 
            <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">prob</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">final_diameter</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">transition_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_nominal</span><span class="p">)</span>
            <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;complex&quot;</span><span class="p">,</span><span class="s2">&quot;transitional&quot;</span><span class="p">]</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">p</span><span class="p">]</span> 
            <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">prob</span><span class="p">)</span>                

    <span class="k">return</span> <span class="n">morphology_type</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="cratermaker.core.scale.Scale.projectile_to_crater" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">projectile_to_crater</span><span class="p">(</span><span class="n">projectile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert a projectile to its corresponding crater.</p>
<h5 id="cratermaker.core.scale.Scale.projectile_to_crater--parameters">Parameters</h5>
<p>projectile : Projectile
    The projectile to be converted.
target : Target
    The target body being impacted
Returns</p>
<hr />
<p>Crater
    The crater resulting from the impact of the projectile.</p>

          <details class="quote">
            <summary>Source code in <code>cratermaker/core/scale.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">projectile_to_crater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projectile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a projectile to its corresponding crater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    projectile : Projectile</span>
<span class="sd">        The projectile to be converted.</span>
<span class="sd">    target : Target</span>
<span class="sd">        The target body being impacted</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Crater</span>
<span class="sd">        The crater resulting from the impact of the projectile.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.crater</span> <span class="kn">import</span> <span class="n">Crater</span>
    <span class="n">transient_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projectile_to_transient</span><span class="p">(</span><span class="n">projectile</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
    <span class="n">crater</span> <span class="o">=</span> <span class="n">Crater</span><span class="p">(</span><span class="n">transient_diameter</span><span class="o">=</span><span class="n">transient_diameter</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">crater</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="cratermaker.core.scale.Scale.transient_to_final" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">transient_to_final</span><span class="p">(</span><span class="n">transient_diameter</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Computes the final diameter of a crater based on its transient diameter and morphology type.</p>
<p>This method first ensures that the morphology type of the crater is computed. It then calculates
the final crater diameter based on the transient diameter using scaling factors for simple or complex
crater morphologies. This is a bit more complicated than the final-&gt;transient calculation  because In 
the transition region, a particular transient crater diameter could be associate with simple, complex, 
or transitional crater morphologies. Therefore we need to monte carlo our way into a solution to avoid 
biasing in favor of one or another in the transient-&gt;final computation</p>
<h5 id="cratermaker.core.scale.Scale.transient_to_final--parameters">Parameters</h5>
<p>transient_diameter : float-like
    The transient diameter in meters of the crater to convert to final</p>
<h5 id="cratermaker.core.scale.Scale.transient_to_final--returns">Returns</h5>
<p>np.float64
    The final crater diameter
str
    The morphology type of the crater</p>

          <details class="quote">
            <summary>Source code in <code>cratermaker/core/scale.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transient_to_final</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transient_diameter</span><span class="p">:</span> <span class="n">FloatLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the final diameter of a crater based on its transient diameter and morphology type.</span>

<span class="sd">    This method first ensures that the morphology type of the crater is computed. It then calculates</span>
<span class="sd">    the final crater diameter based on the transient diameter using scaling factors for simple or complex</span>
<span class="sd">    crater morphologies. This is a bit more complicated than the final-&gt;transient calculation  because In </span>
<span class="sd">    the transition region, a particular transient crater diameter could be associate with simple, complex, </span>
<span class="sd">    or transitional crater morphologies. Therefore we need to monte carlo our way into a solution to avoid </span>
<span class="sd">    biasing in favor of one or another in the transient-&gt;final computation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    transient_diameter : float-like</span>
<span class="sd">        The transient diameter in meters of the crater to convert to final</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.float64</span>
<span class="sd">        The final crater diameter</span>
<span class="sd">    str</span>
<span class="sd">        The morphology type of the crater</span>
<span class="sd">    &quot;&quot;&quot;</span> 

    <span class="c1"># Invert the final -&gt; transient functions for  each crater type</span>
    <span class="n">final_diameter_simple</span> <span class="o">=</span> <span class="n">transient_diameter</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">simple_enlargement_factor</span>
    <span class="k">def</span> <span class="nf">root_func</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">,</span><span class="n">Dt</span><span class="p">,</span><span class="n">scale</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">scale</span><span class="o">.</span><span class="n">f2t_complex</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span> <span class="o">-</span> <span class="n">Dt</span>

    <span class="n">sol</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">root_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span><span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">final_diameter_simple</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">final_diameter_simple</span><span class="p">),</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">transient_diameter</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
    <span class="n">final_diameter_complex</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">root</span>

    <span class="c1"># Evaluate the potential morphology that this transient crater could be consistent with. If both potential diameter values are unambigusously is unambiguosuly simple or complex, go with that.</span>
    <span class="c1"># If there is disagreement, then we&#39;ll draw the answer from a hat and just check to make sure that final_diameter &gt; transient_diameter </span>
    <span class="n">morphology_options</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_morphology_type</span><span class="p">(</span><span class="n">final_diameter_simple</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">get_morphology_type</span><span class="p">(</span><span class="n">final_diameter_complex</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">morphology_options</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># We have agreement!</span>
        <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">morphology_type</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span>
            <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_simple</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_complex</span> <span class="c1"># this includes transitional types as well</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">if</span> <span class="s2">&quot;simple&quot;</span> <span class="ow">in</span> <span class="n">morphology_options</span><span class="p">:</span> <span class="c1"># The disagreement is between simple/complex or simple/transitional</span>
            <span class="k">if</span> <span class="n">morphology_options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span>
                <span class="n">sind</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">cind</span> <span class="o">=</span> <span class="mi">1</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sind</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">cind</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Randomly draw a morphology based on weighting by whichever option is closest to the transition </span>
            <span class="n">is_simple</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">final_diameter_complex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_diameter</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">final_diameter_simple</span> <span class="o">-</span> <span class="n">final_diameter_complex</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_simple</span><span class="p">:</span>
                <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_simple</span>
                <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_options</span><span class="p">[</span><span class="n">sind</span><span class="p">]</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_complex</span>
                <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_options</span><span class="p">[</span><span class="n">cind</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">final_diameter_complex</span>
            <span class="n">morphology_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">morphology_options</span><span class="p">)</span>

    <span class="n">final_diameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">final_diameter</span><span class="p">)</span>
    <span class="n">morphology_type</span> <span class="o">=</span> <span class="n">morphology_type</span>
    <span class="k">return</span> <span class="n">final_diameter</span><span class="p">,</span> <span class="n">morphology_type</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>